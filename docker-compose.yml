version: "3.9"

services:
  api-pyservice:
    build:
      context: .
      dockerfile: Dockerfile

    container_name: api-pyservice
    restart: unless-stopped

    env_file:
      - .env

    ports:
      - "4001:4001"

    volumes:
      # ðŸ”¥ MONTA TODO EL PROYECTO â†’ git pull = cambios inmediatos
      - .:/app

      # ðŸ”¥ Asegura el .env dentro del contenedor
      - ./.env:/app/.env

    environment:
      # ðŸ”¥ Flask autoreload + modo desarrollo
      FLASK_APP: index.py
      FLASK_ENV: development
      FLASK_DEBUG: 1
      FLASK_RUN_HOST: 0.0.0.0
      FLASK_RUN_PORT: 4001
      PYTHONPATH: /app/src

    command: flask run --reload

    networks:
      - backend_net

networks:
  backend_net:
